<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head th:replace="~{fragments/header.html :: head}">
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <title>코드 글쓰기</title>
</head>
<body>
  <div th:insert="~{fragments/navbar :: navbar}" id="codeForm"></div>
  <div>
    <p>Task: </p>
    <h1 th:text="${taskTitle}"></h1>
  </div>
  <div>
      <form id="writeForm" class="offset-3 col-6 form-group" autocomplete="off" th:method="post" th:action="|@{/boards/code/{postId}/write (postId=${taskId})}|" th:object="${boardCreateRequest}">
          <input type="hidden" name="taskId" id="taskId" th:value="${taskId}" />
          <input class="mt-4" type="text" id="title" maxlength='30' th:field="*{title}" placeholder="제목을 입력하세요"/>
          제목 (최대 30자)
          <br/>
          <input type="text" id="writer" name="writer" maxlength='10' th:value="${userName}"/>
          작성자 (최대 10자)
          <br/>
          <div id="content_div">
              <textarea name="codeContent" id="codeContent"  th:field="*{codeContent}" hidden></textarea>
              <textarea class="form-control" style="height:500px; width:47vw;margin-right: 3vw; display: inline-block" maxlength='1000' id="content" th:field="*{content}" name="content"></textarea>
              <div id="editor" style="width:50vw; height: 500px; display: inline-block; float: right"></div>
          </div>
          <div align="center">
              <button class="btn body-btn" type="submit">등록</button>
          </div>
      </form>

  </div>

<!--  <script src="https://cdn.jsdelivr.net/npm/ace-builds@1.4.12/src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>-->
<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.15.0/ace.js" integrity="sha512-vgArOyW+sdp69qm3025hO1uoxhMZ7rzc2NZbaC/0eUD92rYIx4YSI/NdQ1+oINXb8tXoFQJyQqpfV9KxoPGuCw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->
  <script src="http://ajaxorg.github.io/ace-builds/src/ace.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
  <script>
    let editor = ace.edit("editor");
    editor.setTheme("ace/theme/monokai");
    editor.session.setMode("ace/mode/javascript");
    let postContent = $("#codeContent").val()


    $("#editor").on("propertychange change keyup paste input ", function() {
      postContent = editor.getValue();
      console.log(postContent)
    })
    document.getElementById("writeForm").onsubmit = function(evt){
      document.getElementById("codeContent").value = editor.getValue();
    }

  </script>


</body>
</html>